<!doctype html>

<html lang="en">
  <head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width, initial-scale=1, viewport-fit=cover"/>
    <meta http-equiv="X-UA-Compatible" content="ie=edge"/>
    <title>Login to your Outlet</title>
    <!-- CSS files -->
    <link href="./dist/css/tabler.min.css?1684106062" rel="stylesheet"/>
    <link href="./dist/css/tabler-flags.min.css?1684106062" rel="stylesheet"/>
    <link href="./dist/css/tabler-payments.min.css?1684106062" rel="stylesheet"/>
    <link href="./dist/css/tabler-vendors.min.css?1684106062" rel="stylesheet"/>
    <link href="./dist/css/demo.min.css?1684106062" rel="stylesheet"/>
    <style>
      @import url('https://rsms.me/inter/inter.css');
      :root {
      	--tblr-font-sans-serif: 'Inter Var', -apple-system, BlinkMacSystemFont, San Francisco, Segoe UI, Roboto, Helvetica Neue, sans-serif;
      }
      body {
      	font-feature-settings: "cv03", "cv04", "cv11";
      }
    </style>
  </head>
  <body  class=" d-flex flex-column">
    <script src="./dist/js/demo-theme.min.js?1684106062"></script>
    <div class="page page-center">
      <div class="container container-normal py-4">
        <div class="row align-items-center g-4">
          <div class="col-lg">
            <div class="container-tight">
              <div class="text-center mb-4">
                <a href="signup.html" class="navbar-brand navbar-brand-autodark"><img src="./static/logo.png" height="36" alt=""></a>
              </div>
             
              <div class="card card-md">
                <div class="card-body">
                  <div class="error-message" id="response-message" style="text-align: center; color: rgb(231, 0, 0);"></div>
                  <h2 class="h2 text-center mb-4">Log into your Outlet</h2>
                  <form action="php/login.php" method="post" onsubmit="return validateForm()">
                
                    <div class="mb-3">
                      <label  for="email" class="form-label">Email address</label>
                      <input type="email" id="email" name="email" class="form-control" placeholder="your@email.com" autocomplete="off">
                    </div>
                    <div class="mb-2">
                      <label for="password" class="form-label">
                        Password
                        <span class="form-label-description">
                          <a href="./forgot-password.html">I forgot my password</a>
                        </span>
                      </label>
                      <div class="input-group input-group-flat">
                        <input id="password" name="password" type="password" class="form-control"  placeholder="Your password"  autocomplete="off">
                        <span class="input-group-text">
                          <a href="#" class="link-secondary" title="Show password" data-bs-toggle="tooltip"><!-- Download SVG icon from http://tabler-icons.io/i/eye -->
                            <svg xmlns="http://www.w3.org/2000/svg" class="icon" width="24" height="24" viewBox="0 0 24 24" stroke-width="2" stroke="currentColor" fill="none" stroke-linecap="round" stroke-linejoin="round"><path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" /><path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6" /></svg>
                          </a>
                        </span>
                      </div>
                    </div>
                    <div class="mb-2">
                      <label class="form-check">
                        <input type="checkbox" class="form-check-input"/>
                        <span class="form-check-label">Remember me on this device</span>
                      </label>
                    </div>
                    <div class="form-footer">
                      <button  type="button" onclick="submitForm()" class="btn btn-primary w-100">Sign in</button>
                    </div>
                   
                  </form>
                </div>
              
                <div class="card-body">
                  <div class="row">
                    <div class="text-center text-muted mt-3">
                      Don't have account yet? <a href="./signup.html" tabindex="-1">Sign up</a>
                    </div>
                  </div>
                </div>
              </div>
             
            </div>
          </div>
          <div class="col-lg d-none d-lg-block">
            <img src="./static/illustrations/login.svg" height="300" class="d-block mx-auto" alt="">
          </div>
        </div>
      </div>
    </div>

    <script>
      function submitForm() {
      var xhr = new XMLHttpRequest();
      var form = document.querySelector('form');
      var formData = new FormData(form);
  
      xhr.open('POST', 'php/login.php', true);
  
      xhr.onreadystatechange = function() {
          if (xhr.readyState == 4) {
              if (xhr.status == 200) {
                  document.getElementById('response-message').innerHTML = xhr.responseText;
  
                  // Check for success message in the response
                  if (xhr.responseText.trim() === 'Login Successful') {
                      // Redirect to login.html
                      window.location.href = 'dashboard.php';
                  }
              } else {
                  // Handle other HTTP status codes or errors
                  console.error('Error: ' + xhr.status);
              }
          }
      };
  
      xhr.send(formData);
  }
  
  function validateForm() {
      // Implement any client-side validation if needed
      return true;
  }

  document.addEventListener("DOMContentLoaded", function () {
    const togglePassword = document.querySelectorAll('.link-secondary');

    togglePassword.forEach(function (toggle) {
        toggle.addEventListener('click', function (e) {
            e.preventDefault();
            const passwordInput = this.closest('.input-group').querySelector('input');
            const passwordType = passwordInput.getAttribute('type') === 'password' ? 'text' : 'password';
            passwordInput.setAttribute('type', passwordType);
            
            // Toggle the icon
            const icon = this.querySelector('svg');
            icon.innerHTML = passwordType === 'password'
                ? '<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M10 12a2 2 0 1 0 4 0a2 2 0 0 0 -4 0" /><path d="M21 12c-2.4 4 -5.4 6 -9 6c-3.6 0 -6.6 -2 -9 -6c2.4 -4 5.4 -6 9 -6c3.6 0 6.6 2 9 6" />'
                : '<path stroke="none" d="M0 0h24v24H0z" fill="none"/><path d="M12 12l0 0m0 -2a2 2 0 1 0 4 0a2 2 0 0 0 -4 0"/><path d="M4.94 4.94l14.12 14.12"/><path d="M10.73 9.73a6 6 0 0 0 8.49 8.49"/><path d="M9.27 9.27a6 6 0 0 0 0 8.49"/><path d="M3 3l18 18"/>';
        });
    });
});
    </script>

<script>
  // Function to fetch and store the user's IP information in localStorage
  async function fetchAndStoreIPInfo() {
      try {
          const response = await fetch('https://ipapi.co/json/');
          if (!response.ok) {
              throw new Error('Failed to fetch IP information: ' + response.statusText);
          }
          const data = await response.json();

          // Store the fetched IP information in localStorage
          localStorage.setItem('userInfo', JSON.stringify(data));
          console.log('User IP information stored in localStorage:', data);
      } catch (error) {
          console.error('Error fetching and storing IP information:', error);
      }
  }

  // Call the function when the page is loaded
  window.onload = fetchAndStoreIPInfo;


</script>
    <!-- Libs JS -->
    <!-- Tabler Core -->
    <script src="./dist/js/tabler.min.js?1684106062" defer></script>
    <script src="./dist/js/demo.min.js?1684106062" defer></script>
  </body>
</html>