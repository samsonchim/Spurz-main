<!DOCTYPE html>
<html lang="en" dir="ltr">

<head>
  <meta charset="UTF-8">
  <meta http-equiv="X-UA-Compatible" content="IE=edge" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Create an Outlet</title>
  <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
  <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Roboto:wght@400;500;700&display=swap">
  <link rel="stylesheet" href="./assets/icons/font-awesome-4.7.0/css/font-awesome.min.css">
  <link rel="stylesheet" href="./assets/css/w3pro-4.13.css">
  <link rel="stylesheet" href="./assets/css/w3-theme.css">
  <link rel="stylesheet" href="./assets/css/admin-styles.css">
  <link rel="stylesheet" href="./assets/css/scrollbar.css">
  <link rel="shortcut icon" href="assets/logo.jpg" type="image/x-icon">
</head>
<body>

    <div class="w3-main" style="margin-top:54px">
      <div style="padding:16px 32px">
        <div class="w3-padding-32">
          <div class="w3-auto" style="width:580px">
            <div class="w3-white w3-round w3-margin-bottom w3-border" style="">
              <div class="w3-padding-large">
                <div class="w3-center w3-padding-16">
                  <img src="./assets/logo.png" style="width: 30%;" alt="Spurz" class="w3-image">
                </div>
                <form id="createOutletForm" method="POST">
                  <div id="messageBox" class="w3-padding w3-round" style="display: none;"></div>
                  <div class="w3-margin-bottom">
                      <p>What's your Business Name?</p>
                      <input type="text" name="business_name" class="w3-input w3-round w3-border" placeholder="Eg: Wendy's Apparel" required>
                  </div>
              
                  <div class="category">
                      <p>What's your Business Category?</p>
                      <select class="w3-select w3-round w3-border" name="business_category" required>
                          <option value="" disabled selected>Select Category</option>
                          <option value="Fashion">Fashion</option>
                          <option value="Food">Food</option>
                          <option value="Electronics">Electronics</option>
                          <option value="Home">Home</option>
                          <option value="Health and Beauty">Health & Beauty</option>
                          <option value="Sports">Sports</option>
                          <option value="Books">Books</option>
                          <option value="Ladies">Ladies</option>
                          <option value="Others">Others</option>
                      </select>
                  </div>
              
                  <p>What's your Email?</p>
                  <div class="w3-margin-bottom">
                      <input type="email" name="email" class="w3-input w3-round w3-border" placeholder="Enter Your Email" required>
                  </div>
              
                  <p>Choose a Password</p>
                  <div class="w3-margin-bottom">
                      <input type="password" name="password" class="w3-input w3-round w3-border" placeholder="Choose Password" required>
                  </div>
                  <div class="w3-margin-bottom">
                    <div class="icheck-material-white">
                      <input id="user-checkbox" class="w3-check" type="checkbox" checked="">
                      <label for="user-checkbox">I Agree to the <a href="terms" style="text-decoration:none ;">Terms and Condition</a></label>
                    </div>
                  </div>
                  <div class="w3-margin-bottom">
                    <button type="submit" class="w3-button w3-block w3-round w3-padding" style="background-color: blue; color: white; width: 100%; font-size: 18px;">
                        Create Outlet
                    </button>
                </div>
                
              </form>
              </div>              
              <div class="w3-center w3-border-top">
                <p class="w3-margin"><span class="w3-text-warning">Already have an Outlet?</span> <a href="login.html" style="text-decoration:none ;" > Login here</a></p>
              </div>
            </div>
          </div>
        </div>
      </div>
   
    </div>
  </div>
  <script>
$(document).ready(function () {
    $("#createOutletForm").submit(function (e) {
        e.preventDefault();

        let password = $("input[name='password']").val();
        let messageBox = $("#messageBox");

        // Password validation (8+ characters, at least 1 letter & 1 number)
        let passwordRegex = /^(?=.*[A-Za-z])(?=.*\d)(?=.*[@$!%*?&])[A-Za-z\d@$!%*?&]{8,}$/;
        if (!passwordRegex.test(password)) {
            messageBox.show().html("Error: Password must be at least 8 characters long and include letters, numbers, and special characters (@$!%*?&).")
                .css({"color": "red", "background": "#f8d7da", "border-left": "4px solid red"});
            return;
        }

        $.ajax({
            type: "POST",
            url: "includes/register_outlet.php",
            data: $(this).serialize(),
            dataType: "json",
            success: function (response) {
                console.log(response);

                messageBox.show();
                if (response.success) {
                    messageBox.html(response.message)
                        .css({"color": "black", "background": "#d4edda", "border-left": "4px solid green"});
                    setTimeout(() => window.location.href = "outlet_info.php", 2000);
                } else {
                    messageBox.html("Error: " + response.message)
                        .css({"color": "red", "background": "#f8d7da", "border-left": "4px solid red"});
                }
            },
            error: function (xhr, status, error) {
                console.log("AJAX Error: ", xhr.responseText);
                messageBox.show().html("An error occurred. Please try again.")
                    .css({"color": "red", "background": "#f8d7da", "border-left": "4px solid red"});
            }
        });
    });
});
</script>
</body>

</html>
